.data
    sbox0: .word 0x7b777c63
    sbox1: .word 0xc56f6bf2
    sbox2: .word 0x2b670130
    sbox3: .word 0x76abd7fe
    sbox4: .word 0x7dc982ca
    sbox5: .word 0xf04759fa
    sbox6: .word 0xafa2d4ad
    sbox7: .word 0xc072a49c
    sbox8: .word 0x2693fdb7
    sbox9: .word 0xccf73f36
    sbox10: .word 0xf1e5a534
    sbox11: .word 0x1531d871
    sbox12: .word 0xc323c704
    sbox13: .word 0x9a059618
    sbox14: .word 0xe2801207
    sbox15: .word 0x75b227eb
    sbox16: .word 0x1a2c8309
    sbox17: .word 0xa05a6e1b
    sbox18: .word 0xb3d63b52
    sbox19: .word 0x842fe329
    sbox20: .word 0xed00d153
    sbox21: .word 0x5bb1fc20
    sbox22: .word 0x39becb6a
    sbox23: .word 0xcf584c4a
    sbox24: .word 0xfbaaefd0
    sbox25: .word 0x85334d43
    sbox26: .word 0x7f02f945
    sbox27: .word 0xa89f3c50
    sbox28: .word 0x8f40a351
    sbox29: .word 0xf5389d92
    sbox30: .word 0x21dab6bc
    sbox31: .word 0xd2f3ff10
    sbox32: .word 0xec130ccd
    sbox33: .word 0x1744975f
    sbox34: .word 0x3d7ea7c4
    sbox35: .word 0x73195d64
    sbox36: .word 0xdc4f8160
    sbox37: .word 0x88902a22
    sbox38: .word 0x14b8ee46
    sbox39: .word 0xdb0b5ede
    sbox40: .word 0x0a3a32e0
    sbox41: .word 0x5c240649
    sbox42: .word 0x62acd3c2
    sbox43: .word 0x79e49591
    sbox44: .word 0x6d37c8e7
    sbox45: .word 0xa94ed58d
    sbox46: .word 0xeaf4566c
    sbox47: .word 0x08ae7a65
    sbox48: .word 0x2e2578ba
    sbox49: .word 0xc6b4a61c
    sbox50: .word 0x1f74dde8
    sbox51: .word 0x8a8bbd4b
    sbox52: .word 0x66b53e70
    sbox53: .word 0x0ef60348
    sbox54: .word 0xb9573561
    sbox55: .word 0x9e1dc186
    sbox56: .word 0x1198f8e1
    sbox57: .word 0x948ed969
    sbox58: .word 0xe9871e9b
    sbox59: .word 0xdf2855ce
    sbox60: .word 0x0d89a18c
    sbox61: .word 0x6842e6bf
    sbox62: .word 0x0f2d9941
    sbox63: .word 0x16bb54b0
    isbox0: .word 0xd56a0952
    isbox1: .word 0x38a53630
    isbox2: .word 0x9ea340bf
    isbox3: .word 0xfbd7f381
    isbox4: .word 0x8239e37c
    isbox5: .word 0x87ff2f9b
    isbox6: .word 0x44438e34
    isbox7: .word 0xcbe9dec4
    isbox8: .word 0x32947b54
    isbox9: .word 0x3d23c2a6
    isbox10: .word 0x0b954cee
    isbox11: .word 0x4ec3fa42
    isbox12: .word 0x66a12e08
    isbox13: .word 0xb224d928
    isbox14: .word 0x49a25b76
    isbox15: .word 0x25d18b6d
    isbox16: .word 0x64f6f872
    isbox17: .word 0x16986886
    isbox18: .word 0xcc5ca4d4
    isbox19: .word 0x92b6655d
    isbox20: .word 0x5048706c
    isbox21: .word 0xdab9edfd
    isbox22: .word 0x5746155e
    isbox23: .word 0x849d8da7
    isbox24: .word 0x00abd890
    isbox25: .word 0x0ad3bc8c
    isbox26: .word 0x0558e4f7
    isbox27: .word 0x0645b3b8
    isbox28: .word 0x8f1e2cd0
    isbox29: .word 0x020f3fca
    isbox30: .word 0x03bdafc1
    isbox31: .word 0x6b8a1301
    isbox32: .word 0x4111913a
    isbox33: .word 0xeadc674f
    isbox34: .word 0xcecff297
    isbox35: .word 0x73e6b4f0
    isbox36: .word 0x2274ac96
    isbox37: .word 0x8535ade7
    isbox38: .word 0xe837f9e2
    isbox39: .word 0x6edf751c
    isbox40: .word 0x711af147
    isbox41: .word 0x89c5291d
    isbox42: .word 0x0e62b76f
    isbox43: .word 0x1bbe18aa
    isbox44: .word 0x4b3e56fc
    isbox45: .word 0x2079d2c6
    isbox46: .word 0xfec0db9a
    isbox47: .word 0xf45acd78
    isbox48: .word 0x33a8dd1f
    isbox49: .word 0x31c70788
    isbox50: .word 0x591012b1
    isbox51: .word 0x5fec8027
    isbox52: .word 0xa97f5160
    isbox53: .word 0x0d4ab519
    isbox54: .word 0x9f7ae52d
    isbox55: .word 0xef9cc993
    isbox56: .word 0x4d3be0a0
    isbox57: .word 0xb0f52aae
    isbox58: .word 0x3cbbebc8
    isbox59: .word 0x61995383
    isbox60: .word 0x7e042b17
    isbox61: .word 0x26d677ba
    isbox62: .word 0x631469e1
    isbox63: .word 0x7d0c2155
    rcon0: .word 0x01
    rcon1: .word 0x02
    rcon2: .word 0x04
    rcon3: .word 0x08
    rcon4: .word 0x10
    rcon5: .word 0x20
    rcon6: .word 0x40
    rcon7: .word 0x80
    rcon8: .word 0x1B
    rcon9: .word 0x36
    ct0: .word 0xd8e0c469
    ct1: .word 0x30047b6a
    ct2: .word 0x80b7cdd8
    ct3: .word 0x5ac5b470
    key0: .word 0x03020100
    key1: .word 0x07060504
    key2: .word 0x0b0a0908
    key3: .word 0x0f0e0d0c
    rk0: .word 0

.globl __start
.text

__start:

aes128_dec_key:

    la      a0, rk0
    la      a1, key0
    la      a2, rcon0
    la      s11, sbox0
    la      s10, isbox0

    addi	sp,		sp,		-8
    sw		s0,		0(sp)
    sw		ra,		4(sp)
    mv		s0,		a0
    call	aes128_enc_key
    addi	a0,		s0,		16
    lw		s0,		0(sp)
    lw		ra,		4(sp)
    addi	a1,		a0,		144
    addi	sp,		sp,		8
    j	invmc

aes128_enc_key:

    addi	a3,		a0,		160	#	end pointer

    lw		t0,		0(a1)				#	input key
    lw		t1,		4(a1)
    lw		t2,		8(a1)
    lw		t3,		12(a1)

    sw		t0,		0(a0)				#	first round key
    sw		t1,		4(a0)
    sw		t2,		8(a0)
    sw		t3,		12(a0)

    xori	t0,		t0,		1			#	first round constant
    j		nl0

ekl0:
    addi	a2,		a2,		4
    lw		a1,		0(a2)				#	round constant
    xor		t0,		a1,		t0

nl0:
    slli	a4,		t3,		24			#	rotate
    srli	a1,		t3,		8
    or		a1,		a1,		a4

    addi    sp, sp, -4                  
    sw      a1, 0(sp)
    lb      a1, 0(sp)
    lb      a4, 1(sp)
    lb      a5, 2(sp)
    lb      a6, 3(sp)
    andi    a1, a1, 0x000000ff
    andi    a4, a4, 0x000000ff
    andi    a5, a5, 0x000000ff
    andi    a6, a6, 0x000000ff
    addi    sp, sp, 4

#   saes32_encs		t0, t0, a1, 0
    add     a1, a1, s11
    lb      a1, 0(a1)
    andi    a1, a1, 0x000000ff
    xor     t0, t0, a1

#   saes32_encs		t0, t0, a1, 1
    add     a4, a4, s11
    lb      a4, 0(a4)
    andi    a4, a4, 0x000000ff
    slli    a4, a4, 8
    xor     t0, t0, a4

#   saes32_encs		t0, t0, a1, 2
    add     a5, a5, s11
    lb      a5, 0(a5)
    andi    a5, a5, 0x000000ff
    slli    a5, a5, 16
    xor     t0, t0, a5

#   saes32_encs		t0, t0, a1, 3
    add     a6, a6, s11
    lb      a6, 0(a6)
    andi    a6, a6, 0x000000ff
    slli    a6, a6, 24
    xor     t0, t0, a6

    xor		t1,		t1,		t0
    xor		t2,		t2,		t1
    xor		t3,		t3,		t2

    addi	a0,		a0,		16
    sw		t0,		0(a0)				#	store round key
    sw		t1,		4(a0)
    sw		t2,		8(a0)
    sw		t3,		12(a0)

    bne		a0,		a3,		ekl0
    jr		ra

invmc:
    lw		t0,		0(a0)

#  saes32_encs		t1, x0,	t0, 0
#  saes32_encs		t1, t1, t0, 1
#  saes32_encs		t1, t1, t0, 2
#  saes32_encs		t1, t1, t0, 3

    addi    sp, sp, -4                  
    sw      t0, 0(sp)
    lb      s0, 0(sp)
    lb      s1, 1(sp)
    lb      s2, 2(sp)
    lb      s3, 3(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff
    addi    sp, sp, 4

    add     s0, s0, s11
    lb      s0, 0(s0)
    andi    s0, s0, 0x000000ff
    xor     t1, x0, s0

    add     s1, s1, s11
    lb      s1, 0(s1)
    andi    s1, s1, 0x000000ff
    slli    s1, s1, 8
    xor     t1, t1, s1

    add     s2, s2, s11
    lb      s2, 0(s2)
    andi    s2, s2, 0x000000ff
    slli    s2, s2, 16
    xor     t1, t1, s2

    add     s3, s3, s11
    lb      s3, 0(s3)
    andi    s3, s3, 0x000000ff
    slli    s3, s3, 24
    xor     t1, t1, s3

#   saes32_decsm	t0, x0,	t1, 0
#   saes32_decsm	t0, t0, t1, 1
#   saes32_decsm	t0, t0, t1, 2
#   saes32_decsm	t0, t0, t1, 3
    addi    sp, sp, -4                  
    sw      t1, 0(sp)
    lb      s0, 0(sp)
    lb      s1, 1(sp)
    lb      s2, 2(sp)
    lb      s3, 3(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff
    addi    sp, sp, 4

    jal     decsm_b0
    xor     t0, x0, s7

    jal     decsm_b1
    xor     t0, t0, s7

    jal     decsm_b2
    xor     t0, t0, s7

    jal     decsm_b3
    xor     t0, t0, s7

    sw		t0,		0(a0)
    addi	a0,		a0,		4
    bne		a0,		a1,		invmc
    
aes_dec_rounds:

    la      a1,     ct0
    la      a2,     rk0
    addi    a0,     a2,     176
    addi    a3,     x0,     10

    lw		t4,		0(a1)				#	load ct
    lw		t5,		4(a1)
    lw		t6,		8(a1)
    lw		a7,		12(a1)

    slli	a3,		a3,		4			#	final pointer
    add		a3,		a3,		a2

    lw		t0,		0(a3)				#	load rk
    lw		t1,		4(a3)
    lw		t2,		8(a3)
    lw		t3,		12(a3)

    xor		t0,		t0,		t4			#	ct ^ rk
    xor		t1,		t1,		t5
    xor		t2,		t2,		t6
    xor		t3,		t3,		a7

    j		ent						#	enter loop in middle

xtime_8:
    beq     s5, x0, skip_1
    addi    s4, s4, -256
    xori    s4, s4, 0x1B
skip_1:
    slli    s5, s4, 1
    srli    s6, s4, 7
    beq     s6, x0, skip_2
    addi    s5, s5, -256
    xori    s5, s5, 0x1B
skip_2:
    slli    s6, s5, 1
    srli    s7, s5, 7
    beq     s7, x0, skip_3
    addi    s6, s6, -256
    xori    s6, s6, 0x1B
skip_3:
    jr      ra


decsm_b0:
    add     s0, s0, s10
    lb      s0, 0(s0)
    andi    s0, s0, 0x000000ff
    slli    s4, s0, 1
    srli    s5, s0, 7
    addi    sp, sp, -4
    sw      ra, 0(sp)
    jal     xtime_8
    lw      ra, 0(sp)
    addi    sp, sp, 4

    xor     s5, s5, s6
    xor     s7, s5, s4
    xor     s5, s5, s0
    slli    s5, s5, 16
    xor     s7, s7, s5
    xor     s6, s6, s0
    xor     s4, s4, s6
    slli    s6, s6, 8
    slli    s4, s4, 24
    xor     s7, s7, s6
    xor     s7, s7, s4
    jr      ra

decsm_b1:
    add     s1, s1, s10
    lb      s1, 0(s1)
    andi    s1, s1, 0x000000ff
    slli    s4, s1, 1
    srli    s5, s1, 7
    addi    sp, sp, -4
    sw      ra, 0(sp)
    jal     xtime_8
    lw      ra, 0(sp)
    addi    sp, sp, 4

    xor     s5, s5, s6
    xor     s7, s5, s4
    slli    s7, s7, 8
    xor     s5, s5, s1
    slli    s5, s5, 24
    xor     s7, s7, s5
    xor     s6, s6, s1
    xor     s4, s4, s6
    slli    s6, s6, 16
    xor     s7, s7, s6
    xor     s7, s7, s4
    jr      ra

decsm_b2:
    add     s2, s2, s10
    lb      s2, 0(s2)
    andi    s2, s2, 0x000000ff
    slli    s4, s2, 1
    srli    s5, s2, 7
    addi    sp, sp, -4
    sw      ra, 0(sp)
    jal     xtime_8
    lw      ra, 0(sp)
    addi    sp, sp, 4

    xor     s5, s5, s6
    xor     s7, s5, s4
    slli    s7, s7, 16
    xor     s5, s5, s2
    xor     s7, s7, s5
    xor     s6, s6, s2
    xor     s4, s4, s6
    slli    s6, s6, 24
    slli    s4, s4, 8
    xor     s7, s7, s6
    xor     s7, s7, s4
    jr      ra

decsm_b3:
    add     s3, s3, s10
    lb      s3, 0(s3)
    andi    s3, s3, 0x000000ff
    slli    s4, s3, 1
    srli    s5, s3, 7
    addi    sp, sp, -4
    sw      ra, 0(sp)
    jal     xtime_8
    lw      ra, 0(sp)
    addi    sp, sp, 4

    xor     s5, s5, s6
    xor     s7, s5, s4
    slli    s7, s7, 24
    xor     s5, s5, s3
    slli    s5, s5, 8
    xor     s7, s7, s5
    xor     s6, s6, s3
    xor     s4, s4, s6
    slli    s4, s4, 16
    xor     s7, s7, s6
    xor     s7, s7, s4
    jr      ra

loop:
    #	even round

    addi    sp, sp, -16
    sw      t4, 0(sp)
    sw      t5, 4(sp)
    sw      t6, 8(sp)
    sw      a7, 12(sp)

#   saes32_decsm	t0, t0, t4, 0
#   saes32_decsm	t0, t0, a7, 1
#   saes32_decsm	t0, t0, t6, 2
#   saes32_decsm	t0, t0, t5, 3

    lb      s0, 0(sp)
    lb      s1, 13(sp)
    lb      s2, 10(sp)
    lb      s3, 7(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    jal     decsm_b0
    xor     t0, t0, s7

    jal     decsm_b1
    xor     t0, t0, s7

    jal     decsm_b2
    xor     t0, t0, s7

    jal     decsm_b3
    xor     t0, t0, s7

#   saes32_decsm	t1, t1, t5, 0
#   saes32_decsm	t1, t1, t4, 1
#   saes32_decsm	t1, t1, a7, 2
#   saes32_decsm	t1, t1, t6, 3

    lb      s0, 4(sp)
    lb      s1, 1(sp)
    lb      s2, 14(sp)
    lb      s3, 11(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    jal     decsm_b0
    xor     t1, t1, s7

    jal     decsm_b1
    xor     t1, t1, s7

    jal     decsm_b2
    xor     t1, t1, s7

    jal     decsm_b3
    xor     t1, t1, s7

#   saes32_decsm	t2, t2, t6, 0
#   saes32_decsm	t2, t2, t5, 1
#   saes32_decsm	t2, t2, t4, 2
#   saes32_decsm	t2, t2, a7, 3

    lb      s0, 8(sp)
    lb      s1, 5(sp)
    lb      s2, 2(sp)
    lb      s3, 15(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    jal     decsm_b0
    xor     t2, t2, s7

    jal     decsm_b1
    xor     t2, t2, s7

    jal     decsm_b2
    xor     t2, t2, s7

    jal     decsm_b3
    xor     t2, t2, s7

#   saes32_decsm	t3, t3, a7, 0
#   saes32_decsm	t3, t3, t6, 1
#   saes32_decsm	t3, t3, t5, 2
#   saes32_decsm	t3, t3, t4, 3

    lb      s0, 12(sp)
    lb      s1, 9(sp)
    lb      s2, 6(sp)
    lb      s3, 3(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    jal     decsm_b0
    xor     t3, t3, s7

    jal     decsm_b1
    xor     t3, t3, s7

    jal     decsm_b2
    xor     t3, t3, s7

    jal     decsm_b3
    xor     t3, t3, s7

    addi    sp, sp, 16

ent:
    addi	a3,		a3,		-32
    lw		t4,		16(a3)				#	load round key
    lw		t5,		20(a3)
    lw		t6,		24(a3)
    lw		a7,		28(a3)

    

    #	odd round
    addi    sp, sp, -16
    sw      t0, 0(sp)
    sw      t1, 4(sp)
    sw      t2, 8(sp)
    sw      t3, 12(sp)

#   saes32_decsm	t4, t4, t0, 0
#   saes32_decsm	t4, t4, t3, 1
#   saes32_decsm	t4, t4, t2, 2
#   saes32_decsm	t4, t4, t1, 3

    lb      s0, 0(sp)
    lb      s1, 13(sp)
    lb      s2, 10(sp)
    lb      s3, 7(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    jal     decsm_b0
    xor     t4, t4, s7

    jal     decsm_b1
    xor     t4, t4, s7

    jal     decsm_b2
    xor     t4, t4, s7

    jal     decsm_b3
    xor     t4, t4, s7

#   saes32_decsm	t5, t5, t1, 0
#   saes32_decsm	t5, t5, t0, 1
#   saes32_decsm	t5, t5, t3, 2
#   saes32_decsm	t5, t5, t2, 3

    lb      s0, 4(sp)
    lb      s1, 1(sp)
    lb      s2, 14(sp)
    lb      s3, 11(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    jal     decsm_b0
    xor     t5, t5, s7

    jal     decsm_b1
    xor     t5, t5, s7

    jal     decsm_b2
    xor     t5, t5, s7

    jal     decsm_b3
    xor     t5, t5, s7

#   saes32_decsm	t6, t6, t2, 0
#   saes32_decsm	t6, t6, t1, 1
#   saes32_decsm	t6, t6, t0, 2
#   saes32_decsm	t6, t6, t3, 3

    lb      s0, 8(sp)
    lb      s1, 5(sp)
    lb      s2, 2(sp)
    lb      s3, 15(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    jal     decsm_b0
    xor     t6, t6, s7

    jal     decsm_b1
    xor     t6, t6, s7

    jal     decsm_b2
    xor     t6, t6, s7

    jal     decsm_b3
    xor     t6, t6, s7

#   saes32_decsm	a7, a7, t3, 0
#   saes32_decsm	a7, a7, t2, 1
#   saes32_decsm	a7, a7, t1, 2
#   saes32_decsm	a7, a7, t0, 3

    lb      s0, 12(sp)
    lb      s1, 9(sp)
    lb      s2, 6(sp)
    lb      s3, 3(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    jal     decsm_b0
    xor     a7, a7, s7

    jal     decsm_b1
    xor     a7, a7, s7

    jal     decsm_b2
    xor     a7, a7, s7

    jal     decsm_b3
    xor     a7, a7, s7

    lw		t0,		0(a3)				#	load round key
    lw		t1,		4(a3)
    lw		t2,		8(a3)
    lw		t3,		12(a3)
    addi    sp, sp, 16
    bne		a3,		a2,		loop

    #	final (output) round

    addi    sp, sp, -16
    sw      t4, 0(sp)
    sw      t5, 4(sp)
    sw      t6, 8(sp)
    sw      a7, 12(sp)

#   saes32_decs	t0, t0, t4, 0
#   saes32_decs	t0, t0, a7, 1
#   saes32_decs	t0, t0, t6, 2
#   saes32_decs	t0, t0, t5, 3

    lb      s0, 0(sp)
    lb      s1, 13(sp)
    lb      s2, 10(sp)
    lb      s3, 7(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    add     s0, s0, s10
    lb      s0, 0(s0)
    andi    s0, s0, 0x000000ff
    xor     t0, t0, s0

    add     s1, s1, s10
    lb      s1, 0(s1)
    andi    s1, s1, 0x000000ff
    slli    s1, s1, 8
    xor     t0, t0, s1

    add     s2, s2, s10
    lb      s2, 0(s2)
    andi    s2, s2, 0x000000ff
    slli    s2, s2, 16
    xor     t0, t0, s2

    add     s3, s3, s10
    lb      s3, 0(s3)
    andi    s3, s3, 0x000000ff
    slli    s3, s3, 24
    xor     t0, t0, s3

#   saes32_decs	t1, t1, t5, 0
#   saes32_decs	t1, t1, t4, 1
#   saes32_decs	t1, t1, a7, 2
#   saes32_decs	t1, t1, t6, 3

    lb      s0, 4(sp)
    lb      s1, 1(sp)
    lb      s2, 14(sp)
    lb      s3, 11(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    add     s0, s0, s10
    lb      s0, 0(s0)
    andi    s0, s0, 0x000000ff
    xor     t1, t1, s0

    add     s1, s1, s10
    lb      s1, 0(s1)
    andi    s1, s1, 0x000000ff
    slli    s1, s1, 8
    xor     t1, t1, s1

    add     s2, s2, s10
    lb      s2, 0(s2)
    andi    s2, s2, 0x000000ff
    slli    s2, s2, 16
    xor     t1, t1, s2

    add     s3, s3, s10
    lb      s3, 0(s3)
    andi    s3, s3, 0x000000ff
    slli    s3, s3, 24
    xor     t1, t1, s3

#   saes32_decs	t2, t2, t6, 0
#   saes32_decs	t2, t2, t5, 1
#   saes32_decs	t2, t2, t4, 2
#   saes32_decs	t2, t2, a7, 3

    lb      s0, 8(sp)
    lb      s1, 5(sp)
    lb      s2, 2(sp)
    lb      s3, 15(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    add     s0, s0, s10
    lb      s0, 0(s0)
    andi    s0, s0, 0x000000ff
    xor     t2, t2, s0

    add     s1, s1, s10
    lb      s1, 0(s1)
    andi    s1, s1, 0x000000ff
    slli    s1, s1, 8
    xor     t2, t2, s1

    add     s2, s2, s10
    lb      s2, 0(s2)
    andi    s2, s2, 0x000000ff
    slli    s2, s2, 16
    xor     t2, t2, s2

    add     s3, s3, s10
    lb      s3, 0(s3)
    andi    s3, s3, 0x000000ff
    slli    s3, s3, 24
    xor     t2, t2, s3

#   saes32_decs	t3, t3, a7, 0
#   saes32_decs	t3, t3, t6, 1
#   saes32_decs	t3, t3, t5, 2
#   saes32_decs	t3, t3, t4, 3

    lb      s0, 12(sp)
    lb      s1, 9(sp)
    lb      s2, 6(sp)
    lb      s3, 3(sp)
    andi    s0, s0, 0x000000ff
    andi    s1, s1, 0x000000ff
    andi    s2, s2, 0x000000ff
    andi    s3, s3, 0x000000ff    

    add     s0, s0, s10
    lb      s0, 0(s0)
    andi    s0, s0, 0x000000ff
    xor     t3, t3, s0

    add     s1, s1, s10
    lb      s1, 0(s1)
    andi    s1, s1, 0x000000ff
    slli    s1, s1, 8
    xor     t3, t3, s1

    add     s2, s2, s10
    lb      s2, 0(s2)
    andi    s2, s2, 0x000000ff
    slli    s2, s2, 16
    xor     t3, t3, s2

    add     s3, s3, s10
    lb      s3, 0(s3)
    andi    s3, s3, 0x000000ff
    slli    s3, s3, 24
    xor     t3, t3, s3

    addi    sp, sp, 16

    sw		t0,		0(a0)				#	store pt
    sw		t1,		4(a0)
    sw		t2,		8(a0)
    sw		t3,		12(a0)
    add     x0,     x0,     x0
    ecall